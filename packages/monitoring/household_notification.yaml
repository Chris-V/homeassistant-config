homeassistant:
  customize:
    automation.notify_person_arrives:
      friendly_name: "Notify household arrival"
    automation.sunset_ambiance:
      friendly_name: "Notify household departure"

input_boolean:
  notify_household_changes:
    name: "Notify household changes"
    icon: "mdi:bug"

automation:
  - alias: notify_person_arrives
    trigger:
      platform: state
      entity_id:
        - group.person_chris
        - group.person_karine
      to: "home"
    condition:
      condition: state
      entity_id: input_boolean.notify_household_changes
      state: "on"
    action:
      service: notify.admin
      data_template:
        message: "{{ trigger.to_state.name }} arrived home. Household is {{ states('group.household') }}."
        data:
          tag: "presence_{{ trigger.to_state.entity_id | replace('.', '_') }}"

  - alias: notify_person_leaves
    trigger:
      platform: state
      entity_id:
        - group.person_chris
        - group.person_karine
      from: "home"
    condition:
      condition: state
      entity_id: input_boolean.notify_household_changes
      state: "on"
    action:
      service: notify.admin
      data_template:
        message: "{{ trigger.to_state.name }} left home. Household is {{ states('group.household') }}."
        data:
          tag: "presence_{{ trigger.to_state.entity_id | replace('.', '_') }}"
