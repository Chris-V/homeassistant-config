automation:
  - id: "automation.notify_jammed_lock"
    alias: "notify_jammed_lock"
    initial_state: true
    mode: "parallel"

    trigger:
      - platform: state
        entity_id: "binary_sensor.kitchen_door_lock_jammed"

    action:
      - choose:
          - conditions: "{{ trigger.to_state.state == 'on' }}"
            sequence:
              - service: python_script.notify
                data:
                  title: "The kitchen door lock is jammed."
                  <<: &notification_options
                    tag: "kitchen_lock_jammed"
                    audio: true
                    persistent: true
                    push_target: "household"
                    priority: true
          - conditions: "{{ trigger.to_state.state == 'off' }}"
            sequence:
              - service: python_script.notify
                data:
                  dismiss: true
                  <<: *notification_options
