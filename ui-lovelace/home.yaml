- type: horizontal-stack
  cards:
    - type: custom:decluttering-card
      template: person
      variables:
        - image: /local/secrets/chris.webp
        - person_entity: person.chris
        - mobile_app_entity: device_tracker.chris_mobile_app_pixel_1
    - type: custom:decluttering-card
      template: person
      variables:
        - image: /local/secrets/karine.webp
        - person_entity: person.karine
        - mobile_app_entity: device_tracker.karine_mobile_app_pixel_1

- type: custom:auto-entities
  show_empty: false
  sort:
    method: name
  filter:
    include:
      - group: group.guests
        state: home
  card:
    type: glance
    show_state: false

- type: vertical-stack
  cards:
    - type: horizontal-stack
      cards:
        - type: entity-button
          entity: light.outdoor_lights
          name: Outdoor
          icon: mdi:tree
          tap_action:
            action: toggle
          hold_action:
            action: more-info
        - type: entity-button
          entity: light.ground_floor_lights
          name: Main
          icon: mdi:arrow-up-thick
          tap_action:
            action: toggle
          hold_action:
            action: more-info
        - type: entity-button
          entity: light.basement_lights
          name: Basement
          icon: mdi:arrow-down-thick
          tap_action:
            action: toggle
          hold_action:
            action: more-info

    - type: horizontal-stack
      cards:
        - type: entity-button
          entity: script.ambiance
          name: Ambiance
          icon: mdi:lamp
          tap_action:
            action: call-service
            service: script.turn_on
            service_data:
              entity_id: script.ambiance
          hold_action:
            action: none
        - type: entity-button
          entity: script.bedtime
          name: Bedtime
          icon: mdi:weather-night
          tap_action:
            action: call-service
            service: script.turn_on
            service_data:
              entity_id: script.bedtime
          hold_action:
            action: none
        - type: entity-button
          entity: script.everything_off
          name: All off
          icon: mdi:close-circle-outline
          tap_action:
            action: call-service
            service: script.turn_on
            service_data:
              entity_id: script.everything_off
          hold_action:
            action: none

    - type: horizontal-stack
      cards:
        - <<: &climate_button_card_defaults
            type: custom:button-card
            show_label: true
            layout: icon_name_state2nd
            styles:
              card:
                - height: 64px
              label:
                - font-size: 1rem
                - color: var(--secondary-text-color)
            hold_action:
              action: more-info
          entity: sensor.climate_preset
          name: Apply schedule
          label: >
            [[[ return 'Preset: ' + states['sensor.climate_preset'].state; ]]]
          tap_action:
            action: call-service
            service: script.scheduled_climate_preset

        - <<: *climate_button_card_defaults
          entity: sensor.manual_thermostats_count
          name: Restore to auto
          label: >
            [[[ return states['sensor.manual_thermostats_count'].state + ' in manual mode'; ]]]
          tap_action:
            action: call-service
            service: script.restore_climate_auto_mode


- type: glance
  columns: 3
  show_name: no
  entities:
    - entity: binary_sensor.all_motions
    - entity: sensor.last_motion
      icon: mdi:motion-sensor
    - entity: binary_sensor.all_leaks

    - entity: binary_sensor.all_doors
    - entity: binary_sensor.all_windows
    - entity: sensor.all_batteries

    - entity: binary_sensor.carl_requires_attention
      tap_action:
        action: navigate
        navigation_path: /lovelace/livings
    - entity: binary_sensor.slinky_requires_attention
      tap_action:
        action: navigate
        navigation_path: /lovelace/livings
    - entity: group.all_plants
      tap_action:
        action: navigate
        navigation_path: /lovelace/livings

- type: custom:weather-card
  entity: weather.dark_sky
